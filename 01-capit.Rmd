# Medidas de posição e dispersão

Este tópico está baseado no material de @Sartoris2013.

## Variável Aleatória

- variável aleatória (v.a.) é uma variável que está associada a uma *distribuição de probabilidade*.
- Ou seja, cada valor da v.a. está associada a uma probabilidade.
- O resultado do lançamento de uma dado, que poder ser qualquer número de 1 a 6, está associada a uma probabilidade de $1/6$.

## Média Aritmética Simples

\begin{equation}
    \overline{X} = \frac{1}{n} \sum_{i=1}^{n} X_i
    (\#eq:mediaaritmeticasimples)
\end{equation}
onde $i =1, ...,n$

### Exemplo 1

Qual é a média aritmética de um grupo de cinco pessoas cujas idades são em ordem crescente, 21,23,25,28 e 31. Para responder, basta aplicar \@ref(eq:mediaaritmeticasimples).

\begin{equation*}
  \overline{X} = \frac{21+23+25+28+31}{5} = 25,6
\end{equation*}

### EXemplo 1 no R

```{r media aritmetica ex1}
X <- c(21,23,25,28,31)
X
mediaX <- mean(X)
mediaX
```

### Exemplo 2

Qual é a média aritmética de três provas realizadas por um aluno, cujas notas 
foram 4,6 e 8. Para responder, basta aplicar \@ref(eq:mediaaritmeticasimples).

\begin{equation*}
  \overline{X} = \frac{4+6+8}{3} = 6
\end{equation*}

### Exemplo 2 no R

```{r media aritmetica ex2}
X2 <- c(4,6,8)
X2
mediaX2 <- mean(X2)
mediaX2
```

## Média Aritmética Ponderada

Na média aritmética ponderada, cada valor pode ter importância diferentes do outros valores considerados no computo. A frequência dos valores é muito comumente usada para para dar maior ou menor importância relativa entre os valores considerados no computo da média aritmética ponderada. Veja como fica a fórmula para o cálculo da média aritmética ponderada em \@ref(eq:mediaartimeticaponderada)

\begin{equation}
    \overline{X} = \frac{1}{\sum_{i=1}^{n}w_i} \sum_{i=1}^{n} w_i X_i
    (\#eq:mediaartimeticaponderada)
\end{equation}
onde $w_i$ é a ponderação ou peso associado a iésimo valor de $X$.

Podemos escrever na forma de frequência relativa dos valores da variável $X$:

\begin{equation}
  f_i = \frac{w_i}{\sum_{i=1}^{n}w_i}
  (\#eq:eq13)
\end{equation}

### Exemplo 3

Qual é a média aritmética de um grupo de vinte alunos, oito com 22 anos, sete 
de 23 anos, três de 25 anos, um de 28 anos e um de 30 anos. Para responder, 
basta aplicar \@ref(eq:mediaartimeticaponderada).

\begin{equation*}
  \overline{X} = \frac{22\times 8 + 23\times 7 + 25 \times 3 + 28 \times 1 + 
  30 \times 1}{20} = 23,5
\end{equation*}

### Exemplo 3 no R

```{r media ponderada ex3}
X3 <- c(22,23,25,28,30)
X3
w3 <- c(8,7,3,1,1)
w3
wX3 <- w3*X3
mediaX3 <- sum(wX3)/sum(w3)
mediaX3
```

### Exemplo 4

Qual é a média ponderada de três provas realizadas por um aluno, cujas notas foram 4, 6 e 8. A primeira prova tem peso igual a 1, a segunda tem peso igual a 2 e a terceira tem peso igual a 3. Para responder, basta aplicar \@ref(eq:mediaartimeticaponderada).

\begin{equation*}
  \overline{X} = \frac{4 \times 1 + 6 \times 2 + 8 \times 3}{1 + 2 + 3} \cong 6,7
\end{equation*}

### Exemplo 4 no R

```{r media ponderada ex4}
X4 <- c(4,6,8)
X4
w4 <- c(1,2,3)
w4
wX4 <- w4*X4
mediaX4 <- sum(wX4)/sum(w4)
round(mediaX4, digits = 1)
```

## Média Geométrica Simples

Na média geométrica simples, a forma de obter uma medida resumo ou de tendência central é multiplicar todos os $n$ valores e tirar a raiz enésima do resultado do produtório. Assim é possível ter duas fórmulas para a média geométrica a \@ref(eq:eq14) e \@ref(eq:eq15).

\begin{equation}
    G = \left(\prod_{i=1}^{n} X_i \right)^{\frac{1}{n}}
    (\#eq:eq14)
\end{equation}
ou
\begin{equation}
    G = \sqrt[n]{X_1 \times X_2 \times \ldots \times X_n}
    (\#eq:eq15)
\end{equation}

O que acontece se um dos valores de $X$ for igual a zero? E se um dos valores for negativo?

### EXemplo 5 no R

```{r media geometrica ex5}
X5 <- c(4,6,8)
X5
n <- length(X5)
mediaX5 <- prod(X5)^(1/n)
round(mediaX5, digits = 1)
```

## Média Geométrica Ponderada

Na média geométrica ponderada que podem ser calculadas através de duas fórmulas \@ref(eq:eq16) e \@ref(eq:eq17), cada valor pode ter uma importância diferente em relação aos outros valores no computo da média geométrica. Muito comumente, esta maior ou menor importância pode estar associada a frequência dos valores considerados no cálculo.

\begin{equation}
    G = \left(\prod_{j=1}^{k} X_j^{w_j} \right)^{\frac{1}{n}}
    (\#eq:eq16)
\end{equation}
ou
\begin{equation}
    G = \sqrt[n]{X_1^{w_1} \times X_2^{w_2} \times \ldots \times X_k^{w_k}}
    (\#eq:eq17)
\end{equation}

onde a $\sum_{j=1}^{k} w_j = n$ 

### Exemplo 6

tomando os valores do exemplo 5 e ponderando por 1,2 e 3, temos:

\begin{equation*}
  \sqrt[6]{4^1 \times 6^2 \times 8^3} \cong 6,5
\end{equation*}

### O exemplo 6 no R

```{r medgeom, echo=TRUE}
x6 <- c(4,6,8)
class(x6)
x6
w6 <- c(1,2,3)
w6
G2 <- round((prod(x6^w6))^(1/sum(w6)),1)
G2
```

## Média Harmônica

É o inverso da média dos inversos dos valores da variável que pode ser calculada através das fórmulas \@ref(eq:mediaharmonicasimples) e \@ref(eq:mediaharmonicasimples2).

\begin{equation}
    H = \frac{n}{\sum_{i=1}^{n}\frac{1}{X_i}}
    (\#eq:mediaharmonicasimples)
\end{equation}

\begin{equation}
    H = \frac{n}{\frac{1}{X_1} + \frac{1}{X_2} + \ldots + \frac{1}{X_n}}
    (\#eq:mediaharmonicasimples2)
\end{equation}

O que acontece se um dos valores de $X$ for igual a zero? Para entender essa situação, use o conceito de limite fazendo o valor tender a zero.

### Exemplo 7

Tomando o exemplo das notas, temos:

\begin{equation*}
    H = \frac{3}{\frac{1}{4} + \frac{1}{6} + \frac{1}{8}}\cong 5,5.
\end{equation*}

## Média Harmônica Ponderada

Na média harmônica ponderada, assim como na média aritmética ponderada e na média geométrica ponderada, cada valor pode ter uma importância em relação aos outros valores considerados no seu cálculo. Comumente, a frequência do valor pode associaar uma maior ou menor importância no cálculo da média harmônica ponderada que pode ser calculada através das fórmulas \@ref(eq:mediaharmonicaponderada) e \@ref(eq:mediaharmonicaponderada2)

\begin{equation}
    H = \frac{n}{\sum_{j=1}^{k}w_{j}\frac{1}{X_j}}
    (\#eq:mediaharmonicaponderada)
\end{equation}
ou
\begin{equation}
    H = \frac{n}{w_1\frac{1}{X_1} + w_2\frac{1}{X_2} + \ldots + w_k \frac{1}{X_k}}
    (\#eq:mediaharmonicaponderada2)
\end{equation}

onde a $\sum_{j=1}^{k} w_j = n$ 

### Exemplo 8

Tomando o exemplo das notas

\begin{equation*}
    H = \frac{6}{\frac{1}{4}\times 1 + \frac{1}{6}\times 2 + \frac{1}{8}\times 3}\cong 6,3.
\end{equation*}

### Observação

Tanto para as médias simples como para as ponderadas, a
média aritmética é maior do que a média geométrica e essa, por sua vez, é maior 
que a harmônica. Isso só não vale quando todos os valores são iguais. Veja de forma esquemática em \@ref(eq:diferencaentreasmedias)

\begin{equation}
  \overline{X} \geq G \geq H
  (\#eq:diferencaentreasmedias)
\end{equation}

### Exemplo 9

O aluno tira as seguintes notas bimestrais: 3,4,5,7 e 8,5. Determine qual seria sua média final se esta fosse calculada dos três modos, aritmética, geométirca e harmônica, em cada um dos seguintes casos: i) as notas têm o mesmo peso e; ii) as notas têm pesos diferentes. 

i) As notas dos bimestres têm os mesmos pesos.

  \begin{equation*}
    \overline{X} = \frac{3 + 4,5 + 7 + 8,5}{4} = 23/4 = 5,75
  \end{equation*}
  \begin{equation*}
    G = \sqrt[4]{3 \times 4,5 \times 7 \times 8,5} = \sqrt[4]{803,25} \cong 5,32
  \end{equation*}
  \begin{equation*}
    H = \frac{4}{\frac{1}{3} +\frac{1}{4,5} +\frac{1}{7} +\frac{1}{8,5}}   \cong 4,90
  \end{equation*}

ii) Suponha que agora os pesos para as notas bimestrais sejam, 30\%, 25\%, 25\% e 20\%.

 \begin{equation*}
    \overline{X} = 0,3\times 3 + 0,25\times 4,5 + 0,25\times 7 + 0,20 \times 8,5 = 5,475
  \end{equation*}
  \begin{equation*}
    G = 3^{0,3} \times 4,5^{0,25} \times 7^{0,25} \times 8,5^{0,2} = \cong 5,05
  \end{equation*}
  \begin{equation*}
    H = \frac{1}{0,3\frac{1}{3} +0,25\frac{1}{4,5} +0,25\frac{1}{7} +0,2\frac{1}{8,5}}   \cong 4,66
  \end{equation*}

## Mediana

é o valor que divide um conjunto e dados ordenados ao meio, ou seja, dois 
grupos de valores de igual tamanho. Com base na definição de mediana, o valor da mediana pode ser obtida através da sua posição que proporciona duas situações: i) o número de valores é impar e ii) o número de valores é par.

i) Quando o número de valores é impar, a posiçãodo valor correspondente a mediana é obtida através de \@ref(eq:posicaomedianaimpar):

\begin{equation}
  PMediana_{impar} = \dfrac{n + 1}{2}
  (\#eq:posicaomedianaimpar)
\end{equation}
onde $n$ é o número de valores considerado no cálculo.

ii) Quando o número de valores é par, a posição da mediana é obtida através da média entre os dois valores centrais do conjunto de valores ordenados de menor a maior. O primeiro valor central é definido pela posição obtida através de \@ref(eq:valor1mediaposicaomedianapar)

\begin{equation}
  P1Mediana_{par} = \dfrac{n}{2}
  (\#eq:valor1mediaposicaomedianapar)
\end{equation}
onde $n$ é o número de valores considerado para o cálculo.

O segundo valor central é definido pelas posição obtida através de
\@ref(eq:valor2mediaposicaomedianapar)

\begin{equation}
  P2Mediana_{par} = \dfrac{n}{2} + 1
  (\#eq:valor2mediaposicaomedianapar)
\end{equation}
onde $n$ é o número de valores considerado para o cálculo.

Assim, a mediana quando o número de valores é par é obtida através da média aritmética simples dos valores correspondentes as posições obtidas por \@ref(eq:valor1mediaposicaomedianapar) e por 
\@ref(eq:valor2mediaposicaomedianapar) através de \@ref(eq:medianapar)

\begin{equation}
  Mediana_{par} = \dfrac{ValorCentral_1 + ValorCentral_2}{2}
  (\#eq:medianapar)
\end{equation}

### Exemplo numérico de Mediana quando o número de valores é impar

Seja um conjunto de valores 2,-3,1,-2,0,-1,3. Obtenha a mediana.

Primeiramente ordena-se do menor para o maior.

-3,-2,-1,0,1,2,3

Como se trata de número impar de valores o valor central que divide o conjunto de valores em dois subconjuntos de igual tamanho é o valor da mediana. Neste caso é o zero.

### Mediana no R

```{r mediana}
w <- c(-3, -2, -1, 0, 1, 2, 3)
mediana1 <- median(w)
print(mediana1)
```

### Exemplo numérico de Mediana quando o número de valores é par

No exemplo anterior o conjunto de dados era composto por um número ímpar de valores. Neste exemplo o número de valores ordenado de menor a maior é par. Nesse caso, apesar de existir vários critérios, o mais usual é tirar a média aritmética simples entre os dois valores centrais do conjunto de valores ordenados de menor a maior. Uma vez que não existe um valor que separe dois subconjuntos de igual tamanho, a média aritmética simples destes dois valores é o valor da mediana quando o número total de valores não é impar.

Sejam os valores -2,1,3,2,-3,1. Obtenha a mediana.

Primeiramente ordena-se os seis valores.

-3,-2,-1,1,2,3

Note que trata-se de conjunto com um número par de valores.

Dessa forma, toma-se os dois valores centrais que são -1 e 1 e calcula-se a média aritmética simples. Ou seja, a mediana para este conjunto com seis valores é igual a zero.

### O exemplo do número par de valores no R

```{r mediana com numero par de valores, echo=TRUE}
v <- c(-3, -2, -1, 1, 2, 3)
mediana2 <- median(v)
print(mediana2)
```

## Quartis ou Quartiles

são os valores que dividem o conjunto de dados ordenados em quatro subjconjuntos
de igual tamanho. Ou seja são valores do conjunto que definem o primeiro quarto
dos dados (25%), a metade dos dados (50%) que coincide com a mediana, os três 
quartos dos dados (75%).

Dessa forma para obter os valores que dividem o conjunto de dados ordenados de menor a maior e quatro subconjuntos de igual tamanho, é necessário definir qual é a posição desses valores. Uma vez definido as suas posições pode-se obter os valores corretamente.

A posição do valor que separa o primeiro do segundo quartil é definido por \@ref(eq:posicaoquartilum).

\begin{equation}
  PQ_1 = \dfrac{(n +1)}{4}
  (\#eq:posicaoquartilum)
\end{equation}
onde $n$ é o número de valores.
A posição do valor que separa o segundo do terceiro quartil é definido por \@ref(eq:posicaoquartiltres).

\begin{equation}
  PQ_3 = \dfrac{3(n +1)}{4}
  (\#eq:posicaoquartiltres)
\end{equation}
onde $n$ é o número de valores.

Note que o termo genérico é percentil. Por exemplo, o quintis são os valores que dividem o conjunto de ados ordenados de menor a maior em cinco subconjuntos de igual tamanho. 

### Quartis no R

No R tem uma função específica para a obtenção dos quartis.

```{r quartis}
p <- c(0:100)
length(p)
quantile(p)
faixainterquant <- quantile(p,0.75) - quantile(p,0.25)
faixainterquant
```

### Quartis no R

No R tem uma função específica para a obtenção dos quartis.

```{r quartis2}
p2 <- c(1:100)
length(p2)
quantile(p2)
faixainterquant2 <- quantile(p2,0.75) - quantile(p2,0.25)
faixainterquant2
```

